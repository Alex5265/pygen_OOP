# –ö–ª–∞—Å—Å Peekable üå∂Ô∏è
# –†–µ–∞–ª–∏–∑—É–π—Ç–µ –∫–ª–∞—Å—Å Peekable. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–ª–∞—Å—Å –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–Ω–∏–º–∞—Ç—å –æ–¥–∏–Ω –∞—Ä–≥—É–º–µ–Ω—Ç:
#
# iterable ‚Äî –∏—Ç–µ—Ä–∏—Ä—É–µ–º—ã–π –æ–±—ä–µ–∫—Ç
# –≠–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ Peekable –¥–æ–ª–∂–µ–Ω —è–≤–ª—è—Ç—å—Å—è –∏—Ç–µ—Ä–∞—Ç–æ—Ä–æ–º, –∫–æ—Ç–æ—Ä—ã–π –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã –∏—Ç–µ—Ä–∏—Ä—É–µ–º–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ iterable –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ, –∞ –∑–∞—Ç–µ–º –≤–æ–∑–±—É–∂–¥–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ StopIteration.
#
# –ö–ª–∞—Å—Å Peekable –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –æ–¥–∏–Ω –º–µ—Ç–æ–¥ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞:
#
# peek() ‚Äî –º–µ—Ç–æ–¥, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π —Å–ª–µ–¥—É—é—â–∏–π —ç–ª–µ–º–µ–Ω—Ç –∏—Ç–µ—Ä–∞—Ç–æ—Ä–∞ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Ñ—É–Ω–∫—Ü–∏–∏ next(), –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ —Å–¥–≤–∏–≥–∞—é—â–∏–π –∏—Ç–µ—Ä–∞—Ç–æ—Ä. –ï—Å–ª–∏ –∏—Ç–µ—Ä–∞—Ç–æ—Ä –ø—É—Å—Ç, –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤–æ–∑–±—É–∂–¥–µ–Ω–æ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ StopIteration. –¢–∞–∫–∂–µ –º–µ—Ç–æ–¥ –¥–æ–ª–∂–µ–Ω —É–º–µ—Ç—å –ø—Ä–∏–Ω–∏–º–∞—Ç—å –æ–¥–∏–Ω –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç default ‚Äî –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–µ–Ω –≤–º–µ—Å—Ç–æ –≤–æ–∑–±—É–∂–¥–µ–Ω–∏—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è StopIteration, –µ—Å–ª–∏ –∏—Ç–µ—Ä–∞—Ç–æ—Ä –ø—É—Å—Ç
# –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 1. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è. –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.
#
# –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 2. –ö–ª–∞—Å—Å Peekable –¥–æ–ª–∂–µ–Ω —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª—É –∏—Ç–µ—Ä–∞—Ç–æ—Ä–∞, —Ç–æ –µ—Å—Ç—å –∏–º–µ—Ç—å –º–µ—Ç–æ–¥—ã __iter__() –∏ __next__(). –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∂–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π.


ETERNITY = object()

class Peekable:
    def __init__(self, iterable):
        self.it = iter(iterable)
        self.cache = []

    def __iter__(self):
        return self

    def __next__(self):
        self.peek()
        return self.cache.pop()

    def peek(self, default=ETERNITY):
        if not self.cache:
            try:
                self.cache.append(next(self.it))
            except StopIteration:
                if default is not ETERNITY:
                    return default
                raise
        return self.cache[0]



iterator = Peekable('beegeek')

print(next(iterator))
print(next(iterator))
print(*iterator)
print()

iterator = Peekable('Python')

print(next(iterator))
print(iterator.peek())
print(iterator.peek())
print(next(iterator))
print(iterator.peek())
print(iterator.peek())
print()

iterator = Peekable('Python')

print(*iterator)
print(iterator.peek(None))

iterator = Peekable(iter([]))

try:
    iterator.peek()
except StopIteration:
    print('–ü—É—Å—Ç–æ–π –∏—Ç–µ—Ä–∞—Ç–æ—Ä')

try:
    next(iterator)
except StopIteration:
    print('–ü—É—Å—Ç–æ–π –∏—Ç–µ—Ä–∞—Ç–æ—Ä')


iterator = Peekable([n ** 2 for n in [1, 2, 3]])

print(iterator.peek(default=0))
print(*iterator)
print(iterator.peek(default=None))
print(iterator.peek(default=1))
print(iterator.peek(default=[]))
print(iterator.peek(default=()))

